CREATE PROCEDURE [dbo].pr_CUSTOMATTRIBUTESRECORD_Sync (
@svrName varchar(200),
@svrId int
)
AS
BEGIN
DECLARE @tmpTab TABLE( 
	CUSTOMATTRIBUTESRECORDID int,
	VALUE1 nvarchar(4000),
	VALUE2 nvarchar(4000),
	VALUE3 nvarchar(4000),
	VALUE4 nvarchar(4000),
	VALUE5 nvarchar(4000),
	VALUE6 nvarchar(4000),
	VALUE7 nvarchar(4000),
	VALUE8 nvarchar(4000),
	VALUE9 nvarchar(4000),
	VALUE10 nvarchar(4000),
	VALUE11 nvarchar(4000),
	VALUE12 nvarchar(4000),
	VALUE13 nvarchar(4000),
	VALUE14 nvarchar(4000),
	VALUE15 nvarchar(4000),
	VALUE16 nvarchar(4000),
	VALUE17 nvarchar(4000),
	VALUE18 nvarchar(4000),
	VALUE19 nvarchar(4000),
	VALUE20 nvarchar(4000),
	VALUE21 nvarchar(4000),
	VALUE22 nvarchar(4000),
	VALUE23 nvarchar(4000),
	VALUE24 nvarchar(4000),
	VALUE25 nvarchar(4000),
	VALUE26 nvarchar(4000),
	VALUE27 nvarchar(4000),
	VALUE28 nvarchar(4000),
	VALUE29 nvarchar(4000),
	VALUE30 nvarchar(4000),
	VALUE31 nvarchar(4000),
	VALUE32 nvarchar(4000),
	VALUE33 nvarchar(4000),
	VALUE34 nvarchar(4000),
	VALUE35 nvarchar(4000),
	VALUE36 nvarchar(4000),
	VALUE37 nvarchar(4000),
	VALUE38 nvarchar(4000),
	VALUE39 nvarchar(4000),
	VALUE40 nvarchar(4000),
	VALUE41 nvarchar(4000),
	VALUE42 nvarchar(4000),
	VALUE43 nvarchar(4000),
	VALUE44 nvarchar(4000),
	VALUE45 nvarchar(4000),
	VALUE46 nvarchar(4000),
	VALUE47 nvarchar(4000),
	VALUE48 nvarchar(4000),
	VALUE49 nvarchar(4000),
	VALUE50 nvarchar(4000)
)

DECLARE @insSQL varchar(MAX)= 'SELECT * FROM '+ dbo.GET_OPENQUERY_SQL(@svrName,'SELECT CUSTOMATTRIBUTESRECORDID,VALUE1,VALUE2,VALUE3,VALUE4,VALUE5,VALUE6,VALUE7,VALUE8,VALUE9,VALUE10,VALUE11,VALUE12,VALUE13,VALUE14,VALUE15,VALUE16,VALUE17,VALUE18,VALUE19,VALUE20,VALUE21,VALUE22,VALUE23,VALUE24,VALUE25,VALUE26,VALUE27,VALUE28,VALUE29,VALUE30,VALUE31,VALUE32,VALUE33,VALUE34,VALUE35,VALUE36,VALUE37,VALUE38,VALUE39,VALUE40,VALUE41,VALUE42,VALUE43,VALUE44,VALUE45,VALUE46,VALUE47,VALUE48,VALUE49,VALUE50 FROM CUSTOMATTRIBUTESRECORD_LOG WHERE ROWNUM<100 ORDER BY LOGTIME')
INSERT INTO @tmpTab EXEC(@insSQL)

DECLARE @CUSTOMATTRIBUTESRECORDID int,@VALUE1 nvarchar(4000),@VALUE2 nvarchar(4000),@VALUE3 nvarchar(4000),@VALUE4 nvarchar(4000),@VALUE5 nvarchar(4000),@VALUE6 nvarchar(4000),@VALUE7 nvarchar(4000),@VALUE8 nvarchar(4000),@VALUE9 nvarchar(4000),@VALUE10 nvarchar(4000),@VALUE11 nvarchar(4000),@VALUE12 nvarchar(4000),@VALUE13 nvarchar(4000),@VALUE14 nvarchar(4000),@VALUE15 nvarchar(4000),@VALUE16 nvarchar(4000),@VALUE17 nvarchar(4000),@VALUE18 nvarchar(4000),@VALUE19 nvarchar(4000),@VALUE20 nvarchar(4000),@VALUE21 nvarchar(4000),@VALUE22 nvarchar(4000),@VALUE23 nvarchar(4000),@VALUE24 nvarchar(4000),@VALUE25 nvarchar(4000),@VALUE26 nvarchar(4000),@VALUE27 nvarchar(4000),@VALUE28 nvarchar(4000),@VALUE29 nvarchar(4000),@VALUE30 nvarchar(4000),@VALUE31 nvarchar(4000),@VALUE32 nvarchar(4000),@VALUE33 nvarchar(4000),@VALUE34 nvarchar(4000),@VALUE35 nvarchar(4000),@VALUE36 nvarchar(4000),@VALUE37 nvarchar(4000),@VALUE38 nvarchar(4000),@VALUE39 nvarchar(4000),@VALUE40 nvarchar(4000),@VALUE41 nvarchar(4000),@VALUE42 nvarchar(4000),@VALUE43 nvarchar(4000),@VALUE44 nvarchar(4000),@VALUE45 nvarchar(4000),@VALUE46 nvarchar(4000),@VALUE47 nvarchar(4000),@VALUE48 nvarchar(4000),@VALUE49 nvarchar(4000),@VALUE50 nvarchar(4000)

DECLARE update_cursor CURSOR FOR 
SELECT CUSTOMATTRIBUTESRECORDID,VALUE1,VALUE2,VALUE3,VALUE4,VALUE5,VALUE6,VALUE7,VALUE8,VALUE9,VALUE10,VALUE11,VALUE12,VALUE13,VALUE14,VALUE15,VALUE16,VALUE17,VALUE18,VALUE19,VALUE20,VALUE21,VALUE22,VALUE23,VALUE24,VALUE25,VALUE26,VALUE27,VALUE28,VALUE29,VALUE30,VALUE31,VALUE32,VALUE33,VALUE34,VALUE35,VALUE36,VALUE37,VALUE38,VALUE39,VALUE40,VALUE41,VALUE42,VALUE43,VALUE44,VALUE45,VALUE46,VALUE47,VALUE48,VALUE49,VALUE50 FROM @tmpTab

OPEN update_cursor

FETCH NEXT FROM update_cursor
INTO @CUSTOMATTRIBUTESRECORDID,@VALUE1,@VALUE2,@VALUE3,@VALUE4,@VALUE5,@VALUE6,@VALUE7,@VALUE8,@VALUE9,@VALUE10,@VALUE11,@VALUE12,@VALUE13,@VALUE14,@VALUE15,@VALUE16,@VALUE17,@VALUE18,@VALUE19,@VALUE20,@VALUE21,@VALUE22,@VALUE23,@VALUE24,@VALUE25,@VALUE26,@VALUE27,@VALUE28,@VALUE29,@VALUE30,@VALUE31,@VALUE32,@VALUE33,@VALUE34,@VALUE35,@VALUE36,@VALUE37,@VALUE38,@VALUE39,@VALUE40,@VALUE41,@VALUE42,@VALUE43,@VALUE44,@VALUE45,@VALUE46,@VALUE47,@VALUE48,@VALUE49,@VALUE50

WHILE @@FETCH_STATUS = 0
BEGIN	
	UPDATE CUSTOMATTRIBUTESRECORD SET
		VALUE1=@VALUE1,
		VALUE2=@VALUE2,
		VALUE3=@VALUE3,
		VALUE4=@VALUE4,
		VALUE5=@VALUE5,
		VALUE6=@VALUE6,
		VALUE7=@VALUE7,
		VALUE8=@VALUE8,
		VALUE9=@VALUE9,
		VALUE10=@VALUE10,
		VALUE11=@VALUE11,
		VALUE12=@VALUE12,
		VALUE13=@VALUE13,
		VALUE14=@VALUE14,
		VALUE15=@VALUE15,
		VALUE16=@VALUE16,
		VALUE17=@VALUE17,
		VALUE18=@VALUE18,
		VALUE19=@VALUE19,
		VALUE20=@VALUE20,
		VALUE21=@VALUE21,
		VALUE22=@VALUE22,
		VALUE23=@VALUE23,
		VALUE24=@VALUE24,
		VALUE25=@VALUE25,
		VALUE26=@VALUE26,
		VALUE27=@VALUE27,
		VALUE28=@VALUE28,
		VALUE29=@VALUE29,
		VALUE30=@VALUE30,
		VALUE31=@VALUE31,
		VALUE32=@VALUE32,
		VALUE33=@VALUE33,
		VALUE34=@VALUE34,
		VALUE35=@VALUE35,
		VALUE36=@VALUE36,
		VALUE37=@VALUE37,
		VALUE38=@VALUE38,
		VALUE39=@VALUE39,
		VALUE40=@VALUE40,
		VALUE41=@VALUE41,
		VALUE42=@VALUE42,
		VALUE43=@VALUE43,
		VALUE44=@VALUE44,
		VALUE45=@VALUE45,
		VALUE46=@VALUE46,
		VALUE47=@VALUE47,
		VALUE48=@VALUE48,
		VALUE49=@VALUE49,
		VALUE50=@VALUE50
	WHERE
		SERVERID = @svrId
	AND CUSTOMATTRIBUTESRECORDID=@CUSTOMATTRIBUTESRECORDID

FETCH NEXT FROM update_cursor
INTO @CUSTOMATTRIBUTESRECORDID,@VALUE1,@VALUE2,@VALUE3,@VALUE4,@VALUE5,@VALUE6,@VALUE7,@VALUE8,@VALUE9,@VALUE10,@VALUE11,@VALUE12,@VALUE13,@VALUE14,@VALUE15,@VALUE16,@VALUE17,@VALUE18,@VALUE19,@VALUE20,@VALUE21,@VALUE22,@VALUE23,@VALUE24,@VALUE25,@VALUE26,@VALUE27,@VALUE28,@VALUE29,@VALUE30,@VALUE31,@VALUE32,@VALUE33,@VALUE34,@VALUE35,@VALUE36,@VALUE37,@VALUE38,@VALUE39,@VALUE40,@VALUE41,@VALUE42,@VALUE43,@VALUE44,@VALUE45,@VALUE46,@VALUE47,@VALUE48,@VALUE49,@VALUE50

END

DECLARE @delSQL varchar(MAX) = 'DELETE '+ dbo.GET_OPENQUERY_SQL(@svrName,'SELECT * FROM CUSTOMATTRIBUTESRECORD_LOG WHERE ROWNUM < 100')
EXEC(@delSQL)

CLOSE update_cursor
DEALLOCATE update_cursor

END
